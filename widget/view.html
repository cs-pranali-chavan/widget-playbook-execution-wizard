<!-- Copyright start
  MIT License
  Copyright (c) 2024 Fortinet Inc
  Copyright end -->
<link rel="stylesheet" type="text/css" href="{{widgetCSS}}" />
<div class="modal-header">
    <h3 class="modal-title col-md-9">{{playbookTitle}}</h3>
</div>

<wizard on-finish="close()" indicators-position="top"
    class="cs-wizard ingestion-steps pb-execution-wizard-solutionpack-wizard-steps" name="solutionpackWizard">
    <wz-step wz-title="Start" wz-order="1" class="ingestion-modal-padding wizard-first-step">
        <div class="full-width wz-step-height padding-bottom-md solutionpack-wizard-modal-body">
            <div class="full-height overflow-auto">
                <div class="display-table fixed-table-layout full-height full-width">
                    <div class="full-height display-table-cell vertical-align-middle">
                        <div class="col-md-6 display-flex" style="justify-content: center">
                            <img class="img-responsive" src="{{startIcon}}">
                        </div>
                        <div class="col-md-6 prerequisites-section padding-bottom-25 padding-left-0">
                            <div class="font-size-30 line-height-1">Welcome</div><br />
                            <div class="padding-right-30 margin-top-sm max-width-450px">
                                <p class="font-size-14 margin-bottom-0" data-ng-bind-html="playbookDetails"></p>
                            </div>
                            <button type="button"
                                class="btn btn-primary btn-sm margin-top-xlg text-transform-none font-size-14"
                                data-ng-click="moveNext()" id="solutionpack-next-btn">Let's get started<i
                                    class="fa fa-chevron-right margin-left-sm"></i></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </wz-step>
    <wz-step wz-title="Task Processing" wz-order="2" class="ingestion-modal-padding">
        <div data-ng-if="loadProcessing && !playbookExecutionFailed" class="display-flex justify-content">
            <div class="margin-left-sm margin-right-sm install-progress-icon">
                <div class="custom-installing-spinner-content">
                    <div class="custom-installing-spinner-block">
                        <div class="custom-installing-spinner">
                            <i class="icon icon-installing-loader custom-installing-icon fa fa-spin text-color-orange"></i>
                        </div>
                    </div>
                </div>
            </div>
            <span class="font-size-14 margin-0 margin-top-sm text-color-orange">Task execution is in
                progress.....</span>
        </div>
        <div class="font-size-14 margin-0 text-center margin-top-sm margin-bottom-sm text-success"
            data-ng-if="!loadProcessing">
            <i class="icon icon-approval margin-right-sm"></i>
            <span>Task Completed Successfully</span>
        </div>
        <div class="font-size-14 margin-0 text-center margin-top-sm margin-bottom-sm text-danger"
            data-ng-if="playbookExecutionFailed">
            <i class="icon icon-failed margin-right-sm"></i>
            <span>Task execution failed. Check task detailed flow for more details</span>
        </div>
        <div class="full-width wz-step-height padding-bottom-md solutionpack-wizard-modal-body">
            <div class="overflow-auto">
                <div class="display-table fixed-table-layout full-height full-width">
                    <div class="full-height display-table-cell vertical-align-middle">
                        <div
                            class="display-flex full-width overflow-auto solutionpack-wizard-modal-body wz-step-height">
                            <uib-tabset active="activeTab" class="margin-top-11 width-100pt">
                                <uib-tab index="1" data-ng-click="loadPlaybookData('comments')">
                                    <uib-tab-heading>
                                        <i class="icon icon-history margin-right-sm"></i>Tasks
                                    </uib-tab-heading>
                                    <div class="container full-width">
                                        <div class="col-md-6 display-flex align-items-center">
                                            <div class="full-width margin-left-120 margin-top-10per">
                                                <img class="img-responsive" src="{{taskIcon}}">
                                            </div>
                                        </div>
                                        <div
                                            class="col-md-6 prerequisites-section padding-bottom-25 padding-5 pb-execution-wizard-max-height">
                                            <!-- Content for the right section -->
                                            <ul class="padding-20">
                                                <li data-ng-repeat="comment in commentsContent"
                                                    class="list-unstyled padding-20 margin-top-negative-20">
                                                    <div ng-if="!isObject(comment)"
                                                        class="element-secondary-bgcolor padding-20 padding-top-md padding-bottom-md margin-left-18 solid-border">
                                                        <span ng-bind-html="comment | domPurifySanitize"
                                                            id="{{ 'comment' + $index }}"
                                                            class="break-word custom-markdown-editor"></span>
                                                    </div>
                                                    <div ng-if="isObject(comment)"
                                                        class="element-secondary-bgcolor padding-20 padding-top-md padding-bottom-md margin-left-18 solid-border">
                                                        <i data-ng-if="!pendingInputTabProcessing"></i><span
                                                            class="show-pb-execution-wizard-manual-inputs padding-bottom-65"
                                                            id="{{ 'comment' + $index }}" data-playbook-pending-decision
                                                            data-decision-response="comment" modal="false"></span>
                                                    </div>
                                                    <div class="groove-border-bottom padding-bottom-lg"></div>
                                                </li>
                                                <div data-ng-if="loadProcessing && !playbookExecutionFailed"
                                                    class="display-flex justify-content">
                                                    <cs-spinner class="margin-top-negative-20 state-wait"
                                                        data-show-background="true"></cs-spinner>
                                                    <div data-ng-if="isTasksExecuting"
                                                        class="font-size-14 margin-0 margin-15 text-center text-success">
                                                        Executing Tasks...</div>
                                                    <div data-ng-if="!isTasksExecuting"
                                                        class="font-size-14 margin-0 margin-15 text-center text-success">
                                                        Awaiting User Input...</div>
                                                </div>
                                                <div data-ng-if="!loadProcessing"
                                                    class="font-size-14 margin-0 text-center margin-top-sm text-success text-success">
                                                    <i class="icon icon-approval margin-right-sm"></i>
                                                    <span>Task Completed Successfully</span>
                                                </div>
                                                <div data-ng-if="playbookExecutionFailed"
                                                    class="margin-bottom-sm margin-top-sm text-center text-danger">
                                                    <span>"Error Message": {{playbookResult['Error message']}}</span>
                                                    <div class="groove-border-bottom padding-bottom-lg"></div>
                                                </div>
                                            </ul>
                                            <div id="PlaybookExecutionWizardBottomAnchor"></div>
                                        </div>
                                    </div>
                                </uib-tab>
                                <uib-tab index="2" data-ng-click="loadPlaybookData('logs')">
                                    <uib-tab-heading>
                                        <i class="icon icon-playbooks margin-right-sm"></i>Detailed Flow
                                    </uib-tab-heading>
                                    <div
                                        class="full-width wz-step-height padding-bottom-md solutionpack-wizard-modal-body">
                                        <div class="show-playbook-execution-logs-container"
                                            data-ng-include="'app/components/header/runningPlaybook/runningPlaybook.html'"
                                            style="padding-top: 35px;">
                                        </div>
                                    </div>
                                </uib-tab>
                            </uib-tabset>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="ingestion-modal-footer">
            <button type="button" class="btn btn-primary pull-right btn-sm margin-top-lg margin-right-lg"
                data-ng-click="moveFinishNext()" data-ng-disabled="loadProcessing" id="playbook-log-next-btn">Next<i
                    class="fa fa-chevron-right margin-left-sm"></i>
            </button>
        </div>
    </wz-step>
    <wz-step wz-title="Finish" wz-order="3" class="ingestion-modal-padding wizard-first-step">
        <div class="full-width wz-step-height padding-bottom-md solutionpack-wizard-modal-body">
            <div class="full-height overflow-auto">
                <div class="display-table fixed-table-layout full-height full-width">
                    <div class="full-height display-table-cell vertical-align-middle">
                        <div class="col-md-6 display-flex" style="justify-content: center">
                            <img class="img-responsive" src="{{finishIcon}}">
                        </div>
                        <div class="col-md-6 prerequisites-section padding-bottom-25 padding-left-0">
                            <div class="font-size-40 line-height-1">You are all set!</div><br />
                            <div class="padding-right-30 margin-top-sm max-width-450px">
                                <p class="font-size-14 margin-bottom-0"
                                    data-ng-bind-html="playbookResult.playbook_result"></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="ingestion-modal-footer">
            <button type="button" class="btn btn-sm btn-second-primary margin-top-lg margin-left-lg"
                id="solutionpack-configure-back-btn" data-ng-click="movePrevious()"><i
                    class="fa fa-chevron-left margin-right-sm"></i>Back</button>
            <button type="button" class="btn btn-primary pull-right btn-sm margin-top-lg margin-right-lg"
                data-ng-click="close()" id="solutionpack-configure-finish-btn">Finish<i
                    class="fa fa-chevron-right margin-left-sm"></i>
            </button>
        </div>
    </wz-step>
</wizard>